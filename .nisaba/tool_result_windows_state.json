{
  "windows": {
    "b3dec2d3-202f-4864-bf25-75de3eed668c": {
      "id": "b3dec2d3-202f-4864-bf25-75de3eed668c",
      "window_type": "read_result",
      "content": [
        "<error reading file: [Errno 2] No such file or directory: '.nisaba/augments/foundation/workspace_navigation.md'>"
      ],
      "metadata": {
        "error": "[Errno 2] No such file or directory: '.nisaba/augments/foundation/workspace_navigation.md'"
      },
      "opened_at": 1762468819.3394494,
      "file_path": ".nisaba/augments/foundation/workspace_navigation.md",
      "start_line": 0,
      "end_line": 0,
      "command": "",
      "exit_code": 0,
      "pattern": "",
      "glob_pattern": ""
    },
    "1ff34c8a-610e-4d56-9425-3a273a00c346": {
      "id": "1ff34c8a-610e-4d56-9425-3a273a00c346",
      "window_type": "read_result",
      "content": [
        "# Compressed Workspace Operations",
        "",
        "**Purpose:** Operational reference for workspace tools.",
        "",
        "---",
        "",
        "## Structural View (`structural_view`)",
        "",
        "```",
        "expand(path)        \u2192 show_children | lazy_load@kuzu | idempotent",
        "collapse(path)      \u2192 hide_children | cached | idempotent  ",
        "search(query)       \u2192 P\u00b3(UniXcoder\u00d7CodeBERT) + FTS + RRF | add_markers(\u25cf,score)",
        "clear_search()      \u2192 remove_markers | preserve_navigation",
        "reset(depth=N)      \u2192 collapse_all + expand_to(N) | destructive",
        "```",
        "",
        "**Depth sweet spots:** 0=collapsed, 2=default(pkg), 3=verbose",
        "",
        "---",
        "",
        "## File Windows (`file_windows`)",
        "",
        "```",
        "open_frame(frame_path)              \u2192 {window_id} | full_body(class|fn|pkg)",
        "open_range(file, start, end)        \u2192 {window_id} | arbitrary_lines [1-indexed]",
        "open_search(query, max_N, ctx=3)    \u2192 {window_ids[]} | semantic + context",
        "update(window_id, start, end)       \u2192 re_snapshot | manual_refresh",
        "close(window_id)                    \u2192 remove_single",
        "clear_all()                         \u2192 remove_all | no_undo",
        "status()                            \u2192 {count, total_lines, windows[]}",
        "```",
        "",
        "**Paths:** qualified_name (preferred) | simple_name (fuzzy) | partial_path",
        "",
        "---",
        "",
        "## Nabu Graph (`query_relationships`, `check_impact`, `find_clones`, `get_frame_skeleton`, `show_structure`)",
        "",
        "```",
        "query_relationships(cypher)  \u2192 execute@kuzu | returns_data (not workspace_mutation)",
        "",
        "Schema:",
        "  Frames: {CODEBASE, LANGUAGE, PACKAGE, CLASS, CALLABLE, ",
        "           IF_BLOCK, ELIF_BLOCK, ELSE_BLOCK, FOR_LOOP, WHILE_LOOP,",
        "           TRY_BLOCK, EXCEPT_BLOCK, FINALLY_BLOCK, SWITCH_BLOCK, CASE_BLOCK, WITH_BLOCK}",
        "  ",
        "  Edges: {CONTAINS, CALLS, INHERITS, IMPLEMENTS, IMPORTS, USES}",
        "  ",
        "  Confidence: HIGH(\u22650.8), MEDIUM(0.5-0.79), LOW(0.2-0.49), SPECULATIVE(<0.2)",
        "",
        "check_impact(frame_path)      \u2192 analyze_dependents | pre_refactoring",
        "find_clones(frame_path?)      \u2192 detect_duplicates | entire_codebase if no path",
        "get_frame_skeleton(frame_path) \u2192 outline | lighter than full",
        "show_structure(frame_path)     \u2192 detailed_metadata + relationships",
        "```",
        "",
        "---",
        "",
        "## Nabu Search (`search`)",
        "",
        "```",
        "search(query, top_k=10) \u2192 P\u00b3 + FTS + RRF | ranked_results",
        "",
        "\u2206 structural_view.search: doesn't mutate tree",
        "\u2206 file_windows.open_search: doesn't open windows",
        "Pure query \u2192 returns data for decisions",
        "```",
        "",
        "---",
        "",
        "## Tool Result Windows (`nisaba_tool_windows`)",
        "",
        "```",
        "status()     \u2192 summary{count, windows}",
        "close(id)    \u2192 remove_single",
        "clear_all()  \u2192 remove_all",
        "```",
        "",
        "---",
        "",
        "## Nisaba Tools (Create Result Windows)",
        "",
        "```",
        "nisaba_read(file, start?, end?)    \u2192 {window_id} | content \u2192 TOOL_WINDOWS",
        "nisaba_grep(pattern, path, flags)  \u2192 {window_id} | i,n,C,A,B flags",
        "nisaba_bash(command, cwd?)         \u2192 {window_id} | stdout/stderr \u2192 TOOL_WINDOWS  ",
        "nisaba_glob(pattern, path?)        \u2192 {window_id} | file_matches \u2192 TOOL_WINDOWS",
        "",
        "All: minimal_result, content \u2192 sections \u2191",
        "```",
        "",
        "---",
        "",
        "## Tool Result State Management (`nisaba_tool_result_state`)",
        "",
        "```",
        "close(tool_ids[])    \u2192 compact tool results | save tokens",
        "open(tool_ids[])     \u2192 restore full view",
        "close_all()          \u2192 compact all tracked tools",
        "",
        "Effect: Retroactive transformation in messages array",
        "  Before: Full tool_result with header + content",
        "  After:  \"id: toolu_X, status: success, state: closed\"",
        "  ",
        "Pattern: Execute tools \u2192 observe results \u2192 close unnecessary \u2192 lean context",
        "```",
        "",
        "**Notes:**",
        "- Only affects non-nisaba tools (nisaba tools auto-skipped)",
        "- Changes appear on next request (stateful proxy transformation)",
        "- Tool IDs available in tool_result blocks: `tool_use_id: toolu_X`",
        "",
        "---",
        "",
        "## Augments (`activate_augments`, `deactivate_augments`, `learn_augment`, `pin_augment`, `unpin_augment`)",
        "",
        "```",
        "activate(patterns[])    \u2192 load@system_prompt | wildcards | auto_dependencies",
        "deactivate(patterns[])  \u2192 unload@system_prompt",
        "learn(group, name, md)  \u2192 create .nisaba/augments/{group}/{name}.md",
        "pin(patterns[])         \u2192 always_active | cannot_deactivate",
        "unpin(patterns[])       \u2192 remove_pin_protection",
        "```",
        "",
        "**Perception shift:** activate \u2192 mid_roundtrip mutation \u2192 future_synthesis uses new_perception",
        "",
        "---",
        "",
        "## Todos (`nisaba_todo_write`)",
        "",
        "```",
        "set(todos[])     \u2192 replace_all",
        "add(todos[])     \u2192 append",
        "update(todos[])  \u2192 merge",
        "clear()          \u2192 remove_all",
        "",
        "Format: {content: str, status?: str}",
        "Persistence: across(sessions) = true | survives /clear",
        "```",
        "",
        "---",
        "",
        "## Context Budget",
        "",
        "```",
        "File_Windows:",
        "  Small:  1-3 windows,  50-150 lines",
        "  Medium: 4-6 windows, 150-350 lines \u2190 sweet_spot",
        "  Large:  7-10 windows, 350-500 lines \u2190 pushing_limits",
        "  Over:   10+ windows,  500+ lines \u2190 explosion_risk",
        "",
        "Target: 200-400 lines total",
        "",
        "Structural_View:",
        "  Start: collapsed | depth=2",
        "  Expand: selective (10-30 nodes comfortable)",
        "  Search: add_markers, not expand_all",
        "  Reset: when lost | switching_focus",
        "",
        "Tool_Windows:",
        "  Accumulate like file_windows",
        "  Close after synthesis",
        "  clear_all when switching_tasks",
        "",
        "Augments:",
        "  Load: 2-5 typically",
        "  Foundation: ~3000 tokens baseline",
        "  Specialized: focused knowledge",
        "  Unload: when switching_domains",
        "",
        "Management:",
        "  Monitor: file_windows.status(), nisaba_tool_windows.status()",
        "  Close: proactively after understanding",
        "  Prefer: clear_all when switching",
        "  open_search: efficient (snippets vs full files)",
        "  Aim: lean_visibility",
        "```",
        "",
        "---",
        "",
        "## Symbology",
        "",
        "```",
        "Structural_View:",
        "  + collapsed [N+ children]",
        "  - expanded",
        "  \u00b7 leaf (no children)",
        "  \u25cf search_hit(RRF_score)",
        "  [N+] child_count",
        "",
        "Paths:",
        "  full: nabu_nisaba.python_root.nabu.FrameCache",
        "  simple: FrameCache (fuzzy if unique)",
        "  partial: nabu.core, nabu.mcp.tools",
        "  best: copy from HTML comments <!-- qualified_name -->",
        "```",
        "",
        "---",
        "",
        "## Integration Patterns",
        "",
        "```",
        "structural_view(search) \u2192 file_windows(open_frame) | compare_implementations",
        "query_relationships(cypher) \u2192 file_windows(open) | inspect_callers  ",
        "search(semantic) \u2192 structural_view(expand) \u2192 file_windows(open) | deep_dive",
        "nisaba_grep(pattern) \u2192 file_windows(open_frame) | detailed_inspection",
        "check_impact(frame) \u2192 file_windows(open) | review_affected",
        "```",
        "",
        "---",
        "",
        "## Quick Reference",
        "",
        "```",
        "\u2207(visibility):",
        "  file_windows.status() \u2192 current_windows{count, lines}",
        "  nisaba_tool_windows.status() \u2192 result_windows",
        "  ",
        "\u2206(cleanup):",
        "  file_windows.clear_all()",
        "  nisaba_tool_windows.clear_all()",
        "  ",
        "Pattern: status \u2192 decide \u2192 close/keep",
        "```",
        "",
        "---",
        "",
        "**Quick. Precise. Operational.** \ud83d\udda4",
        "",
        "---",
        "",
        "**Symbols:**",
        "- \u2192 : returns/produces",
        "- \u2206 : difference/change",
        "- \u2207 : navigation/traversal",
        "- @ : at/in location",
        "- \u2190 : recommended/optimal",
        "- {} : returns object",
        "- [] : array/list",
        "- | : or/such that",
        "- \u2265 : greater than or equal",
        "- < : less than",
        "",
        "**REQUIRES:** __base/002_compressed_environment_mechanics",
        "",
        "---"
      ],
      "metadata": {
        "total_lines": 246
      },
      "opened_at": 1762468819.4369485,
      "file_path": ".nisaba/augments/__base/003_compressed_workspace_operations.md",
      "start_line": 1,
      "end_line": 246,
      "command": "",
      "exit_code": 0,
      "pattern": "",
      "glob_pattern": ""
    }
  }
}